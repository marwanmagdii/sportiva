<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sportiva - My Dashboard</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Tailwind gray-50 */
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #d1d5db; /* gray-300 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #9ca3af; /* gray-400 */
        }
        /* Sidebar active link style (original emerald theme) */
        .sidebar-link-active {
            background-color: #ecfdf5; /* emerald-50 */
            color: #059669; /* emerald-600 */
            border-right: 3px solid #059669;
        }
        /* Bottom nav active link style (new blue theme to match new nav) */
        .bottom-nav-link-active {
            color: #2563eb; /* blue-600 */
        }
        /* Custom styles for the settings page toggle switch */
        .toggle-checkbox:checked + .toggle-label {
            background-color: #059669;
        }
        .toggle-checkbox:checked + .toggle-label .dot {
            transform: translateX(100%);
        }
        .card-shadow {
             box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.07), 0 2px 4px -2px rgb(0 0 0 / 0.07);
        }
        .card-shadow:hover {
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.07), 0 4px 6px -4px rgb(0 0 0 / 0.07);
        }
    </style>
</head>
<body class="bg-gray-50 flex flex-col min-h-screen">

    <div id="app-container" class="flex-grow pb-20 md:pb-0">
        <!-- App content will be rendered here by JavaScript -->
    </div>
    
    <!-- New Footer from Marketplace -->
    <footer class="bg-gray-800 text-white">
        <div class="container mx-auto py-12 px-4 sm:px-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h2 class="text-2xl font-bold">Sportiva</h2>
                    <p class="text-gray-400 mt-2">Your one-stop shop for sports.</p>
                </div>
                <div>
                    <h3 class="font-semibold tracking-wider">Dashboards</h3>
                    <ul class="mt-4 space-y-2">
                        <li><a href="player-dashboard.html" class="text-gray-400 hover:text-white">Player Dashboard</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Field Owner Dashboard</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Coach Dashboard</a></li>
                        <li><a href="marketplace-dashboard.html" class="text-gray-400 hover:text-white">Marketplace Dashboard</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-semibold tracking-wider">Support</h3>
                    <ul class="mt-4 space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white">FAQ</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Help Center</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Contact Us</a></li>
                    </ul>
                </div>
                <div>
                     <h3 class="font-semibold tracking-wider">Follow Us</h3>
                     <div class="flex space-x-4 mt-4">
                         <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-facebook-f"></i></a>
                         <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-twitter"></i></a>
                         <a href="#" class="text-gray-400 hover:text-white"><i class="fab fa-instagram"></i></a>
                     </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-500">
                <p>&copy; 2025 Sportiva. All Rights Reserved.</p>
            </div>
        </div>
    </footer>


    <script>
        // --- APPLICATION STATE ---
        const appState = {
            activePage: 'overview', // Default page
            isProfileDropdownOpen: false,
            isSidebarOpen: false,
            modalContent: null // To hold modal HTML content
        };

        // --- MOCK DATA (EXPANDED FOR ALL SECTIONS) ---
        const mockData = {
            user: {
                name: "Karim Ahmed",
                email: "karim.ahmed@example.com",
                phone: "010-1234-5678",
                location: "Cairo, Egypt",
                profileImage: "images/people/people 1.png"
            },
            stats: {
                bookings: 2,
                matches: 1,
                challenges: 3,
                orders: 1
            },
            bookings: [
                { id: 1, field: "Nasr City Stadium", time: "Aug 7, 2025, 8:00 PM - 9:00 PM", status: "Upcoming", price: "300 EGP", image: "images/field/field 1.jpg" },
                { id: 2, field: "Maadi Sports Club", time: "Aug 10, 2025, 7:00 PM - 8:00 PM", status: "Upcoming", price: "320 EGP", image: "images/field/field 2.webp" },
                { id: 3, field: "Zamalek Club", time: "Jul 28, 2025, 9:00 PM - 10:00 PM", status: "Completed", price: "400 EGP", image: "images/field/field 3.jpeg" },
                { id: 4, field: "Heliopolis SC", time: "Jul 15, 2025, 6:00 PM - 7:00 PM", status: "Completed", price: "250 EGP", image: "images/field/field 4.jpg" },
                { id: 5, field: "Mohandessin Park", time: "Jun 20, 2025, 8:00 PM - 9:00 PM", status: "Cancelled", price: "350 EGP", image: "images/field/field 5.jpeg" }
            ],
            orders: [
                { id: 1, name: "Football Shoes", orderId: "#125-8736", date: "Aug 1, 2025", price: "$89.99", status: "Pending", image: "images/marketplace/blue shoes.png" },
                { id: 2, name: "Official Match Ball", orderId: "#125-8612", date: "Jul 25, 2025", price: "$120.00", status: "Delivered", image: "images/marketplace/football grey.png" },
                { id: 3, name: "Goalkeeper Gloves", orderId: "#125-8554", date: "Jul 18, 2025", price: "$59.99", status: "Delivered", image: "images/marketplace/Goalkeeper Gloves black.png" }
            ],
            team: {
                name: "Maadi Warriors",
                record: "5W - 2L - 1D",
                nextMatch: "vs. Heliopolis United",
                matchDetails: "Aug 15, 2025 at Maadi SC",
                memberCount: 11,
                members: [
                    { name: "Karim Ahmed", role: "Captain / Defender", img: "images/people/people 1.png" },
                    { name: "Ali Hassan", role: "Forward", img: "images/people/people 2.png" },
                    { name: "Omar Sherif", role: "Midfielder", img: "images/people/people 3.png" },
                    { name: "Nour El-Sayed", role: "Goalkeeper", img: "images/people/people 4.png" },
                    { name: "Hana Gamal", role: "Forward", img: "images/people/people 5.png" },
                    { name: "Youssef Ali", role: "Defender", img: "images/people/people 6.png" },
                    { name: "Fatma Said", role: "Midfielder", img: "images/people/people 7.png" },
                    { name: "Mohamed Adel", role: "Midfielder", img: "images/people/people 8.png" },
                    { name: "Salma Ibrahim", role: "Forward", img: "images/people/people 9.png" },
                    { name: "Ahmed Zaki", role: "Defender", img: "images/people/people 10.png" },
                    { name: "Laila Fathy", role: "Goalkeeper", img: "images/people/people 11.png" },
                ]
            },
            challenges: [
                { id: 1, name: "Friendly 5-a-side", status: "Waiting for opponent", statusColor: "orange", details: "Nasr City Stadium, Aug 12" },
                { id: 2, name: "7-a-side Tournament", status: "Joined (3/8 Teams)", statusColor: "blue", details: "Starts Sep 1, 2025" },
                { id: 3, name: "Weekend Kickabout", status: "Won (2-1)", statusColor: "green", details: "vs Cairo Pyramids, Aug 2" },
                { id: 4, name: "Night League", status: "Lost (3-5)", statusColor: "red", details: "vs Zamalek Legends, Jul 29" }
            ]
        };

        // --- TEMPLATE RENDERING FUNCTIONS ---

        // New Header Function from Marketplace, with original profile icon
        function renderHeader() {
            return `
                <header class="bg-white shadow-sm sticky top-0 z-50">
                    <nav class="container mx-auto px-4 sm:px-6 py-4 flex justify-between items-center">
                        <div class="flex items-center">
                            <button id="mobile-menu-button" class="md:hidden text-gray-600 hover:text-blue-600 focus:outline-none mr-4">
                                <i class="fas fa-bars fa-lg"></i>
                            </button>
                            <a href="index.html" class="flex items-center space-x-2">
                                <img src="images/logo/Sportiva logo.png" alt="Sportiva Logo" class="h-10 w-10" onerror="this.onerror=null;this.src='https://placehold.co/40x40/10b981/FFFFFF?text=S';">
                                <span class="text-3xl font-bold text-emerald-600">Sportiva</span>
                            </a>
                        </div>
                        <div class="hidden md:flex items-center space-x-8">
                             <a href="fields.html" class="text-gray-600 hover:text-emerald-600 transition">Fields</a>
                             <a href="community.html" class="text-gray-600 hover:text-emerald-600 transition">Community</a>
                             <a href="marketplace.html" class="text-gray-600 hover:text-emerald-600 transition">Marketplace</a>
                             <a href="about-us.html" class="text-gray-600 hover:text-emerald-600 transition">About Us</a>
                        </div>
                        <div class="relative">
                            <button id="profile-button" class="block">
                                <img src="${mockData.user.profileImage}" alt="Profile" class="w-10 h-10 rounded-full object-cover border-2 border-emerald-500 hover:border-emerald-600 transition" onerror="this.onerror=null;this.src='https://placehold.co/40x40/E0E0E0/333333?text=KA';">
                            </button>
                            <div id="profile-dropdown" class="${appState.isProfileDropdownOpen ? '' : 'hidden'} absolute right-0 mt-2 w-48 bg-white rounded-md shadow-xl z-50">
                                <div class="px-4 py-3 border-b">
                                    <p class="text-sm font-semibold text-gray-800">${mockData.user.name}</p>
                                    <p class="text-xs text-gray-500 truncate">${mockData.user.email}</p>
                                </div>
                                <a href="#" data-page="overview" class="nav-link block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">My Dashboard</a>
                                <a href="#" data-page="settings" class="nav-link block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Settings</a>
                                <a href="#" data-page="signout" class="nav-link block px-4 py-2 text-sm text-red-600 hover:bg-gray-100">Sign Out</a>
                            </div>
                        </div>
                    </nav>
                </header>
            `;
        }

        function renderSidebar() {
            const links = [
                { id: 'overview', icon: 'fa-tachometer-alt', text: 'Overview' },
                { id: 'bookings', icon: 'fa-calendar-alt', text: 'My Bookings' },
                { id: 'team', icon: 'fa-users', text: 'My Team' },
                { id: 'orders', icon: 'fa-shopping-cart', text: 'My Orders' },
                { id: 'challenges', icon: 'fa-trophy', text: 'My Challenges' },
                { id: 'settings', icon: 'fa-cog', text: 'Settings' },
            ];

            return `
                <aside id="sidebar" class="fixed top-0 left-0 w-64 bg-white h-full shadow-lg transform ${appState.isSidebarOpen ? 'translate-x-0' : '-translate-x-full'} transition-transform duration-300 ease-in-out z-50 md:sticky md:top-[72px] md:h-screen md:translate-x-0">
                    <div class="p-6 text-center border-b">
                        <img src="${mockData.user.profileImage}" alt="User Profile" class="w-24 h-24 rounded-full mx-auto mb-3 border-4 border-emerald-200 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/96x96/E0E0E0/333333?text=KA';">
                        <h3 class="text-xl font-bold text-gray-800">${mockData.user.name}</h3>
                        <p class="text-sm text-gray-500">${mockData.user.location}</p>
                    </div>
                    <nav class="mt-6">
                        ${links.map(link => `
                            <a href="#" data-page="${link.id}" class="nav-link flex items-center px-6 py-3 text-gray-600 hover:bg-gray-100 ${appState.activePage === link.id ? 'sidebar-link-active' : ''}">
                                <i class="fas ${link.icon} w-6 text-center mr-3"></i>
                                <span class="${appState.activePage === link.id ? 'font-semibold' : ''}">${link.text}</span>
                            </a>
                        `).join('')}
                    </nav>
                </aside>
            `;
        }

        function renderBottomNav() {
             const navItems = [
                { id: 'overview', icon: 'fa-home', text: 'Home' },
                { id: 'bookings', icon: 'fa-calendar-check', text: 'Bookings' },
                { id: 'team', icon: 'fa-users', text: 'Team' },
                { id: 'orders', icon: 'fa-box', text: 'Orders' },
            ];
            return `
                <nav class="md:hidden fixed bottom-0 left-0 right-0 bg-white shadow-t-md z-40 border-t border-gray-200">
                    <div class="flex justify-around">
                        ${navItems.map(item => `
                            <a href="#" data-page="${item.id}" class="nav-link flex-1 flex flex-col items-center justify-center py-2 text-gray-500 hover:text-blue-600 transition-colors ${appState.activePage === item.id ? 'bottom-nav-link-active' : ''}">
                                <i class="fas ${item.icon} fa-lg mb-1"></i>
                                <span class="text-xs font-medium">${item.text}</span>
                            </a>
                        `).join('')}
                    </div>
                </nav>
            `;
        }
        
        function renderModal() {
            if (!appState.modalContent) return '';
            return `
                <div id="modal-overlay" class="fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4">
                    <div class="bg-white rounded-lg shadow-xl max-w-md w-full relative p-6" onclick="event.stopPropagation()">
                        <button onclick="closeModal()" class="absolute top-2 right-4 text-gray-500 hover:text-gray-800 text-3xl">&times;</button>
                        ${appState.modalContent}
                    </div>
                </div>
            `;
        }

        // --- CONTENT AREA RENDER FUNCTIONS ---

        function renderOverviewContent() {
             return `
                <h1 class="text-3xl font-extrabold text-gray-900 mb-2">Welcome back, ${mockData.user.name.split(' ')[0]}!</h1>
                <p class="text-gray-600 mb-8">Here's your personal dashboard. Ready for the next match?</p>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6 mb-8">
                    <div class="bg-white p-4 rounded-xl shadow-md flex flex-col justify-center items-center text-center"><div class="bg-emerald-100 text-emerald-600 p-3 rounded-full mb-2"><i class="fas fa-calendar-check fa-lg"></i></div><div><p class="text-2xl font-bold text-gray-900">${mockData.stats.bookings}</p><p class="text-xs font-medium text-gray-500">Bookings</p></div></div>
                    <div class="bg-white p-4 rounded-xl shadow-md flex flex-col justify-center items-center text-center"><div class="bg-blue-100 text-blue-600 p-3 rounded-full mb-2"><i class="fas fa-shield-alt fa-lg"></i></div><div><p class="text-2xl font-bold text-gray-900">${mockData.stats.matches}</p><p class="text-xs font-medium text-gray-500">Matches</p></div></div>
                    <div class="bg-white p-4 rounded-xl shadow-md flex flex-col justify-center items-center text-center"><div class="bg-orange-100 text-orange-600 p-3 rounded-full mb-2"><i class="fas fa-fire fa-lg"></i></div><div><p class="text-2xl font-bold text-gray-900">${mockData.stats.challenges}</p><p class="text-xs font-medium text-gray-500">Challenges</p></div></div>
                    <div class="bg-white p-4 rounded-xl shadow-md flex flex-col justify-center items-center text-center"><div class="bg-purple-100 text-purple-600 p-3 rounded-full mb-2"><i class="fas fa-box fa-lg"></i></div><div><p class="text-2xl font-bold text-gray-900">${mockData.stats.orders}</p><p class="text-xs font-medium text-gray-500">Orders</p></div></div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 space-y-8">
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-xl font-bold text-gray-800 mb-4">Upcoming Bookings</h2>
                            <div class="space-y-4">
                                ${mockData.bookings.filter(b => b.status === 'Upcoming').map(b => `
                                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                                    <div class="flex items-center">
                                        <img src="${b.image}" alt="${b.field}" class="w-16 h-12 rounded-lg object-cover mr-4" onerror="this.onerror=null;this.src='https://placehold.co/64x48/E0E0E0/333333?text=Field';">
                                        <div>
                                            <p class="font-bold text-gray-800">${b.field}</p>
                                            <p class="text-sm text-gray-500">${b.time}</p>
                                        </div>
                                    </div>
                                    <button data-action="view-booking" data-id="${b.id}" class="text-emerald-600 font-semibold hover:underline">View</button>
                                </div>`).join('')}
                            </div>
                            <a href="fields.html" class="block text-center mt-6 w-full bg-emerald-600 text-white font-semibold py-3 rounded-lg hover:bg-emerald-700 transition">Book a New Field</a>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-xl font-bold text-gray-800 mb-4">Recent Marketplace Orders</h2>
                            <div class="divide-y divide-gray-200">
                                ${mockData.orders.map(o => `
                                <div class="flex items-center justify-between py-3">
                                    <div class="flex items-center"><img src="${o.image}" alt="${o.name}" class="w-12 h-12 sm:w-16 sm:h-16 rounded-md object-cover mr-4" onerror="this.onerror=null;this.src='https://placehold.co/64x64/E0E0E0/333333?text=Item';"><div><p class="font-bold text-gray-800">${o.name}</p><p class="text-sm text-gray-500">Order ${o.orderId}</p></div></div>
                                    <div class="text-right"><p class="font-semibold text-gray-700">${o.price}</p><span class="text-xs font-medium px-2 py-1 rounded-full ${o.status === 'Pending' ? 'text-orange-500 bg-orange-100' : 'text-green-500 bg-green-100'}">${o.status}</span></div>
                                </div>`).join('')}
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-1 space-y-8">
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-xl font-bold text-gray-800 mb-4">My Team: ${mockData.team.name}</h2>
                            <div class="mb-4"><p class="text-sm font-semibold text-gray-600">Next Match:</p><p class="text-md text-gray-800">${mockData.team.nextMatch}</p><p class="text-sm text-gray-500">${mockData.team.matchDetails}</p></div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-2">Team Members (${mockData.team.memberCount})</h3>
                            <div class="flex -space-x-2 overflow-hidden">
                                ${mockData.team.members.slice(0, 4).map(m => `<img class="inline-block h-10 w-10 rounded-full ring-2 ring-white" src="${m.img}" alt="${m.name}" onerror="this.onerror=null;this.src='https://placehold.co/40x40/E0E0E0/333333?text=P';">`).join('')}
                                <div class="h-10 w-10 rounded-full ring-2 ring-white bg-gray-200 flex items-center justify-center text-sm font-bold text-gray-600">+${mockData.team.memberCount - 4}</div>
                            </div>
                            <button data-action="view-match-details" class="mt-6 w-full bg-blue-600 text-white font-semibold py-3 rounded-lg hover:bg-blue-700 transition">Match Details</button>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function renderBookingsContent() {
            const upcomingBookings = mockData.bookings.filter(b => b.status === 'Upcoming');
            const pastBookings = mockData.bookings.filter(b => b.status !== 'Upcoming');
            return `
                <h1 class="text-3xl font-extrabold text-gray-900 mb-8">My Bookings</h1>
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-md">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Upcoming</h2>
                    ${upcomingBookings.length > 0 ? upcomingBookings.map(b => `
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 bg-gray-50 rounded-lg mb-4">
                        <div class="flex items-center mb-3 sm:mb-0">
                             <img src="${b.image}" alt="${b.field}" class="w-20 h-16 rounded-lg object-cover mr-4" onerror="this.onerror=null;this.src='https://placehold.co/80x64/E0E0E0/333333?text=Field';">
                            <div><p class="font-bold text-gray-800">${b.field}</p><p class="text-sm text-gray-500">${b.time}</p></div>
                        </div>
                        <div class="flex items-center space-x-2 self-end sm:self-center">
                            <button data-action="cancel-booking" data-id="${b.id}" class="text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-lg transition">Cancel</button>
                            <button data-action="view-booking" data-id="${b.id}" class="text-sm bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-2 px-4 rounded-lg transition">Details</button>
                        </div>
                    </div>`).join('') : '<p class="text-gray-500">No upcoming bookings.</p>'}
                </div>
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-md mt-8">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">History</h2>
                    
                    <!-- Mobile Card View -->
                    <div class="space-y-4 md:hidden">
                        ${pastBookings.map(b => `
                            <div class="bg-gray-50 rounded-lg p-4 shadow">
                                <div class="flex items-center mb-3">
                                    <img src="${b.image}" class="w-16 h-16 rounded-md object-cover mr-4" onerror="this.onerror=null;this.src='https://placehold.co/64x64/E0E0E0/333333?text=Field';">
                                    <div>
                                        <p class="font-bold text-gray-800">${b.field}</p>
                                        <p class="text-sm text-gray-500">${b.time}</p>
                                    </div>
                                </div>
                                <div class="flex justify-between items-center text-sm">
                                    <span class="font-semibold text-gray-700">${b.price}</span>
                                    <span class="text-xs font-medium px-2 py-1 rounded-full ${b.status === 'Completed' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}">${b.status}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <!-- Desktop Table View -->
                    <div class="hidden md:block overflow-x-auto">
                        <table class="w-full text-left min-w-[600px]">
                            <thead><tr class="border-b text-sm text-gray-500"><th class="py-2 px-2">Field</th><th class="py-2 px-2">Date & Time</th><th class="py-2 px-2">Status</th><th class="py-2 px-2">Price</th></tr></thead>
                            <tbody>
                            ${pastBookings.map(b => `
                                <tr class="border-b"><td class="py-3 px-2 font-medium text-gray-800">${b.field}</td><td class="py-3 px-2 text-gray-600">${b.time}</td><td class="py-3 px-2"><span class="text-xs font-medium px-2 py-1 rounded-full ${b.status === 'Completed' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}">${b.status}</span></td><td class="py-3 px-2 text-gray-600">${b.price}</td></tr>`).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderTeamContent() {
            return `
                <h1 class="text-3xl font-extrabold text-gray-900 mb-8">My Team</h1>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 bg-white p-4 sm:p-6 rounded-xl shadow-md">
                        <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4">
                            <h2 class="text-2xl font-bold text-gray-800 mb-2 sm:mb-0">${mockData.team.name}</h2>
                            <div class="text-left sm:text-right"><p class="font-bold text-lg text-emerald-600">${mockData.team.record}</p><p class="text-sm text-gray-500">Current Record</p></div>
                        </div>
                        <h3 class="font-semibold text-gray-700 mb-4">Team Roster</h3>
                        <div class="space-y-3">
                        ${mockData.team.members.map(m => `
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                <div class="flex items-center"><img src="${m.img}" class="w-10 h-10 rounded-full object-cover mr-4" onerror="this.onerror=null;this.src='https://placehold.co/40x40/E0E0E0/333333?text=P';"><div><p class="font-semibold text-gray-800">${m.name}</p><p class="text-sm text-gray-500">${m.role}</p></div></div>
                                <button data-action="view-profile" data-name="${m.name}" class="text-sm text-blue-600 hover:underline">Profile</button>
                            </div>
                        `).join('')}
                        </div>
                    </div>
                    <div class="lg:col-span-1 space-y-8">
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Next Match</h3>
                            <p class="font-semibold text-lg text-gray-900">${mockData.team.nextMatch}</p><p class="text-gray-600">${mockData.team.matchDetails}</p>
                            <button data-action="view-match-details" class="mt-4 w-full bg-emerald-600 text-white font-semibold py-2 rounded-lg hover:bg-emerald-700 transition">Match Details</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderOrdersContent() {
             return `
                <h1 class="text-3xl font-extrabold text-gray-900 mb-8">My Orders</h1>
                <div class="bg-white rounded-xl shadow-md">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left min-w-[700px]">
                            <thead class="border-b"><tr class="text-sm text-gray-500"><th class="p-4 font-medium">Product</th><th class="p-4 font-medium">Order ID</th><th class="p-4 font-medium">Date</th><th class="p-4 font-medium">Total</th><th class="p-4 font-medium">Status</th><th class="p-4 font-medium">Actions</th></tr></thead>
                            <tbody class="divide-y">
                            ${mockData.orders.map(o => `
                                <tr>
                                    <td class="p-4"><div class="flex items-center"><img src="${o.image}" alt="${o.name}" class="w-12 h-12 rounded-md object-cover mr-4" onerror="this.onerror=null;this.src='https://placehold.co/48x48/E0E0E0/333333?text=Item';"><span class="font-semibold text-gray-800">${o.name}</span></div></td>
                                    <td class="p-4 text-gray-600">${o.orderId}</td><td class="p-4 text-gray-600">${o.date}</td><td class="p-4 font-semibold text-gray-800">${o.price}</td>
                                    <td class="p-4"><span class="text-xs font-medium px-2 py-1 rounded-full ${o.status === 'Pending' ? 'bg-orange-100 text-orange-700' : 'bg-green-100 text-green-700'}">${o.status}</span></td>
                                    <td class="p-4"><button data-action="view-invoice" data-id="${o.id}" class="text-emerald-600 font-semibold hover:underline">View Invoice</button></td>
                                </tr>
                            `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
               `;
        }

        function renderChallengesContent() {
            const statusStyles = {
                orange: { bg: 'bg-orange-50', text: 'text-orange-800', detail: 'text-orange-600' },
                blue: { bg: 'bg-blue-50', text: 'text-blue-800', detail: 'text-blue-600' },
                green: { bg: 'bg-green-50', text: 'text-green-800', detail: 'text-green-600' },
                red: { bg: 'bg-red-50', text: 'text-red-800', detail: 'text-red-600' }
            };
            return `
                <h1 class="text-3xl font-extrabold text-gray-900 mb-8">My Challenges</h1>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                ${mockData.challenges.map(c => `
                    <div class="bg-white p-6 rounded-xl shadow-md flex flex-col sm:flex-row sm:items-center justify-between">
                        <div class="mb-3 sm:mb-0">
                            <p class="font-bold text-lg text-gray-800">${c.name}</p>
                            <p class="text-sm ${statusStyles[c.statusColor].detail} font-medium">${c.details}</p>
                        </div>
                        <span class="text-sm font-bold px-3 py-1 rounded-full ${statusStyles[c.statusColor].bg} ${statusStyles[c.statusColor].text} self-start sm:self-center">${c.status}</span>
                    </div>
                `).join('')}
                </div>
                <button data-action="create-challenge" class="mt-8 w-full md:w-auto bg-orange-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-orange-700 transition">Create New Challenge</button>
            `;
        }

        function renderSettingsContent() {
            return `
                <h1 class="text-3xl font-extrabold text-gray-900 mb-8">Settings</h1>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 space-y-8">
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-xl font-bold text-gray-800 mb-4">Personal Information</h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><label class="block text-sm font-medium text-gray-600">Full Name</label><input type="text" value="${mockData.user.name}" class="mt-1 p-2 w-full border rounded-md"></div>
                                <div><label class="block text-sm font-medium text-gray-600">Email Address</label><input type="email" value="${mockData.user.email}" class="mt-1 p-2 w-full border rounded-md"></div>
                                <div><label class="block text-sm font-medium text-gray-600">Phone Number</label><input type="tel" value="${mockData.user.phone}" class="mt-1 p-2 w-full border rounded-md"></div>
                                <div><label class="block text-sm font-medium text-gray-600">Location</label><input type="text" value="${mockData.user.location}" class="mt-1 p-2 w-full border rounded-md"></div>
                            </div>
                            <button class="mt-6 bg-emerald-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-emerald-700 transition">Save Changes</button>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-md">
                             <h2 class="text-xl font-bold text-gray-800 mb-4">Change Password</h2>
                             <div class="space-y-4">
                                 <div><label class="block text-sm font-medium text-gray-600">Current Password</label><input type="password" placeholder="••••••••" class="mt-1 p-2 w-full border rounded-md"></div>
                                 <div><label class="block text-sm font-medium text-gray-600">New Password</label><input type="password" placeholder="••••••••" class="mt-1 p-2 w-full border rounded-md"></div>
                                 <div><label class="block text-sm font-medium text-gray-600">Confirm New Password</label><input type="password" placeholder="••••••••" class="mt-1 p-2 w-full border rounded-md"></div>
                             </div>
                             <button class="mt-6 bg-emerald-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-emerald-700 transition">Update Password</button>
                        </div>
                    </div>
                    <div class="lg:col-span-1">
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-xl font-bold text-gray-800 mb-4">Notifications</h2>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between"><span class="text-gray-700">Booking Confirmations</span><label class="flex items-center cursor-pointer"><div class="relative"><input type="checkbox" class="sr-only toggle-checkbox"><div class="block bg-gray-200 w-10 h-5 rounded-full toggle-label transition"></div><div class="dot absolute left-0.5 top-0.5 bg-white w-4 h-4 rounded-full transition"></div></div></label></div>
                                <div class="flex items-center justify-between"><span class="text-gray-700">Team Updates</span><label class="flex items-center cursor-pointer"><div class="relative"><input type="checkbox" class="sr-only toggle-checkbox" checked><div class="block bg-gray-200 w-10 h-5 rounded-full toggle-label transition"></div><div class="dot absolute left-0.5 top-0.5 bg-white w-4 h-4 rounded-full transition"></div></div></label></div>
                                <div class="flex items-center justify-between"><span class="text-gray-700">New Challenges</span><label class="flex items-center cursor-pointer"><div class="relative"><input type="checkbox" class="sr-only toggle-checkbox" checked><div class="block bg-gray-200 w-10 h-5 rounded-full toggle-label transition"></div><div class="dot absolute left-0.5 top-0.5 bg-white w-4 h-4 rounded-full transition"></div></div></label></div>
                                <div class="flex items-center justify-between"><span class="text-gray-700">Promotional Offers</span><label class="flex items-center cursor-pointer"><div class="relative"><input type="checkbox" class="sr-only toggle-checkbox"><div class="block bg-gray-200 w-10 h-5 rounded-full toggle-label transition"></div><div class="dot absolute left-0.5 top-0.5 bg-white w-4 h-4 rounded-full transition"></div></div></label></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function renderSignOutContent() {
             return `
                <div class="text-center py-20">
                    <h1 class="text-3xl font-extrabold text-gray-900 mb-2">You have been signed out.</h1>
                    <p class="text-gray-600 mb-8">Thank you for using Sportiva. We hope to see you again soon!</p>
                    <a href="index.html" class="bg-emerald-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-emerald-700 transition">Return to Homepage</a>
                </div>
            `;
        }

        // --- MODAL CONTENT GENERATORS ---
        function showBookingDetailsModal(bookingId) {
            const booking = mockData.bookings.find(b => b.id === bookingId);
            if (!booking) return;
            appState.modalContent = `
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Booking Details</h2>
                <div class="space-y-2 text-left">
                    <p><strong class="font-semibold text-gray-600">Field:</strong> ${booking.field}</p>
                    <p><strong class="font-semibold text-gray-600">Date & Time:</strong> ${booking.time}</p>
                    <p><strong class="font-semibold text-gray-600">Price:</strong> ${booking.price}</p>
                    <p><strong class="font-semibold text-gray-600">Status:</strong> <span class="font-medium px-2 py-1 rounded-full text-xs ${booking.status === 'Upcoming' ? 'bg-blue-100 text-blue-700' : 'bg-gray-100 text-gray-700'}">${booking.status}</span></p>
                </div>
                <button onclick="closeModal()" class="mt-6 w-full bg-emerald-600 text-white font-semibold py-2 rounded-lg hover:bg-emerald-700 transition">Close</button>
            `;
            render();
        }

        function showCancelBookingModal(bookingId) {
            const booking = mockData.bookings.find(b => b.id === bookingId);
            if (!booking) return;
             appState.modalContent = `
                <h2 class="text-2xl font-bold text-gray-800 mb-2 text-center">Confirm Cancellation</h2>
                <p class="text-center text-gray-600 mb-6">Are you sure you want to cancel your booking at <br><strong>${booking.field}</strong>?</p>
                <div class="flex justify-center space-x-4">
                    <button onclick="closeModal()" class="bg-gray-200 text-gray-800 font-semibold py-2 px-6 rounded-lg hover:bg-gray-300">No, Keep It</button>
                    <button onclick="closeModal()" class="bg-red-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-red-700">Yes, Cancel</button>
                </div>
            `;
            render();
        }

        function showProfileModal(memberName) {
            const member = mockData.team.members.find(m => m.name === memberName);
            if (!member) return;
            appState.modalContent = `
                <div class="text-center">
                    <img src="${member.img}" class="w-24 h-24 rounded-full mx-auto mb-4 border-4 border-emerald-200 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/96x96/E0E0E0/333333?text=P';">
                    <h2 class="text-2xl font-bold text-gray-800">${member.name}</h2>
                    <p class="text-gray-600">${member.role}</p>
                    <button class="mt-6 w-full bg-blue-600 text-white font-semibold py-2 rounded-lg hover:bg-blue-700 transition">Send Message</button>
                </div>
            `;
            render();
        }

        function showInvoiceModal(orderId) {
            const order = mockData.orders.find(o => o.id === orderId);
            if (!order) return;
            appState.modalContent = `
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Order Invoice</h2>
                <div class="space-y-2 text-left">
                    <p><strong class="font-semibold text-gray-600">Product:</strong> ${order.name}</p>
                    <p><strong class="font-semibold text-gray-600">Order ID:</strong> ${order.orderId}</p>
                    <p><strong class="font-semibold text-gray-600">Date:</strong> ${order.date}</p>
                    <p><strong class="font-semibold text-gray-600">Total:</strong> ${order.price}</p>
                    <p><strong class="font-semibold text-gray-600">Status:</strong> <span class="font-medium px-2 py-1 rounded-full text-xs ${order.status === 'Pending' ? 'bg-orange-100 text-orange-700' : 'bg-green-100 text-green-700'}">${order.status}</span></p>
                </div>
                 <button onclick="closeModal()" class="mt-6 w-full bg-emerald-600 text-white font-semibold py-2 rounded-lg hover:bg-emerald-700 transition">Close</button>
            `;
            render();
        }

        function showMatchDetailsModal() {
            const locationName = mockData.team.matchDetails.split(' at ')[1];
            const mapsLink = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(locationName)}`;
            appState.modalContent = `
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Next Match Details</h2>
                <div class="space-y-3 text-left">
                    <p><strong class="font-semibold text-gray-600">Opponent:</strong> ${mockData.team.nextMatch.replace('vs. ', '')}</p>
                    <p><strong class="font-semibold text-gray-600">Date & Time:</strong> ${mockData.team.matchDetails.split(' at ')[0]}</p>
                    <p><strong class="font-semibold text-gray-600">Location:</strong> 
                        <a href="${mapsLink}" target="_blank" rel="noopener noreferrer" class="text-emerald-600 hover:underline">
                            ${locationName} <i class="fas fa-external-link-alt fa-xs ml-1"></i>
                        </a>
                    </p>
                </div>
                <button onclick="closeModal()" class="mt-6 w-full bg-emerald-600 text-white font-semibold py-2 rounded-lg hover:bg-emerald-700 transition">Close</button>
            `;
            render();
        }

        function showCreateChallengeModal() {
            appState.modalContent = `
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Create a New Challenge</h2>
                <form>
                    <div class="space-y-4">
                        <div>
                            <label for="challenge-name" class="block text-sm font-medium text-gray-700">Challenge Name</label>
                            <input type="text" id="challenge-name" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500" placeholder="e.g., Weekend 5-a-side">
                        </div>
                        <div>
                            <label for="challenge-location" class="block text-sm font-medium text-gray-700">Location</label>
                            <input type="text" id="challenge-location" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500" placeholder="e.g., Nasr City Stadium">
                        </div>
                        <div>
                            <label for="challenge-date" class="block text-sm font-medium text-gray-700">Date & Time</label>
                            <input type="datetime-local" id="challenge-date" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                    </div>
                    <div class="mt-6 flex justify-end space-x-3">
                        <button type="button" onclick="closeModal()" class="bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300">Cancel</button>
                        <button type="submit" class="bg-orange-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-orange-700">Create Challenge</button>
                    </div>
                </form>
            `;
            render();
        }
        
        function closeModal() {
            appState.modalContent = null;
            render();
        }

        // --- MAIN RENDER & EVENT HANDLING ---

        function renderMainContent() {
            const container = document.getElementById('dashboard-content');
            if (!container) return;

            switch (appState.activePage) {
                case 'overview': container.innerHTML = renderOverviewContent(); break;
                case 'bookings': container.innerHTML = renderBookingsContent(); break;
                case 'team': container.innerHTML = renderTeamContent(); break;
                case 'orders': container.innerHTML = renderOrdersContent(); break;
                case 'challenges': container.innerHTML = renderChallengesContent(); break;
                case 'settings': container.innerHTML = renderSettingsContent(); break;
                case 'signout': container.innerHTML = renderSignOutContent(); break;
                default: container.innerHTML = renderOverviewContent();
            }
        }

        function attachEventListeners() {
            // Mobile menu toggle
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            if (mobileMenuButton) {
                mobileMenuButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    appState.isSidebarOpen = !appState.isSidebarOpen;
                    render();
                });
            }

            // Profile dropdown toggle
            const profileButton = document.getElementById('profile-button');
            if (profileButton) {
                profileButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    appState.isProfileDropdownOpen = !appState.isProfileDropdownOpen;
                    render();
                });
            }
            
            // Close dropdowns/sidebar when clicking outside
            document.body.addEventListener('click', (e) => {
                let changed = false;
                if (appState.isProfileDropdownOpen) {
                    appState.isProfileDropdownOpen = false;
                    changed = true;
                }
                if (appState.isSidebarOpen) {
                    // Don't close sidebar if clicking on the sidebar itself
                    if (!e.target.closest('#sidebar')) {
                         appState.isSidebarOpen = false;
                         changed = true;
                    }
                }
                if (changed) render();
            });

            // Navigation links (sidebar, bottom nav, dropdown)
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    const page = e.currentTarget.dataset.page;
                    if (page) {
                        appState.activePage = page;
                        appState.isProfileDropdownOpen = false;
                        appState.isSidebarOpen = false;
                        window.scrollTo(0, 0); // Scroll to top on page change
                        render();
                    }
                });
            });
            
            // Event delegation for action buttons inside main content
            const dashboardContent = document.getElementById('dashboard-content');
            if (dashboardContent) {
                dashboardContent.addEventListener('click', e => {
                    const button = e.target.closest('button');
                    if (!button || !button.dataset.action) return;

                    const { action, id, name } = button.dataset;
                    
                    if (action === 'view-booking') showBookingDetailsModal(parseInt(id));
                    if (action === 'cancel-booking') showCancelBookingModal(parseInt(id));
                    if (action === 'view-profile') showProfileModal(name);
                    if (action === 'view-invoice') showInvoiceModal(parseInt(id));
                    if (action === 'view-match-details') showMatchDetailsModal();
                    if (action === 'create-challenge') showCreateChallengeModal();
                });
            }

            // Modal overlay click to close
            const modalOverlay = document.getElementById('modal-overlay');
            if(modalOverlay) {
                modalOverlay.addEventListener('click', closeModal);
            }
        }

        function render() {
            const appContainer = document.getElementById('app-container');
            appContainer.innerHTML = `
                ${renderHeader()}
                <div class="flex flex-1">
                    ${renderSidebar()}
                    <main class="flex-1 p-4 sm:p-6 md:p-10 bg-gray-50">
                        <div class="container mx-auto" id="dashboard-content">
                            <!-- Main content is injected here -->
                        </div>
                    </main>
                </div>
                ${renderBottomNav()}
                ${renderModal()}
            `;
            renderMainContent();
            attachEventListeners();
        }

        // Initial render on page load
        document.addEventListener('DOMContentLoaded', render);

    </script>

</body>
</html>
